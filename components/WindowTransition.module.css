/* ===========================
   OVERLAY
   =========================== */
.overlay {
  position: fixed;
  inset: 0;
  z-index: 9999;
  opacity: 1;
  pointer-events: all;
}

/* ===========================
   WRAP = placement + anim ouverture/fermeture
   (on n'anime PAS l'opacité ici => pas de "cadre vide")
   =========================== */
.windowWrap {
  position: absolute;
  left: 50%;
  top: 18%;
  width: min(860px, calc(100vw - 40px));
  transform: translateX(-50%);
  transform-origin: center;
}

/* ✅ conteneur interne : sert de référence aux absolute (glitchLayer) */
.windowStack {
  position: relative;
}


.overlay[data-phase="opening"] .windowWrap{
  animation: tvOpen 650ms cubic-bezier(.15,.9,.2,1) forwards;
}

.overlay[data-phase="closing"] .windowWrap{
  animation: tvClose 280ms cubic-bezier(.2,.9,.2,1) forwards;
}

/* petit flash CRT à la fermeture */
.overlay[data-phase="closing"] .window::after{
  content:"";
  position:absolute;
  inset:0;
  pointer-events:none;
  background: rgba(255,255,255,0.10);
  animation: crtFlash 220ms ease-out forwards;
  z-index: 999;
}

@keyframes crtFlash{
  0%{ opacity: 0; }
  35%{ opacity: 1; }
  100%{ opacity: 0; }
}


@keyframes tvOpen{
  0%{
    transform: translateX(-50%) scaleY(0.03);
    filter: brightness(1.35) contrast(1.25) blur(1.6px);
  }
  35%{
    transform: translateX(-50%) scaleY(0.10);
    filter: brightness(1.25) contrast(1.2) blur(1px);
  }
  70%{
    transform: translateX(-50%) scaleY(1.02);
    filter: brightness(1.05) contrast(1.05) blur(0.3px);
  }
  100%{
    transform: translateX(-50%) scaleY(1);
    filter: none;
  }
}

@keyframes tvClose{
  0%{
    transform: translateX(-50%) scaleY(1);
    filter: none;
  }
  60%{
    transform: translateX(-50%) scaleY(0.08);
    filter: brightness(1.2) contrast(1.25) blur(0.8px);
  }
  100%{
    transform: translateX(-50%) scaleY(0.02);
    filter: brightness(1.35) contrast(1.3) blur(1.4px);
  }
}


/* ===========================
   WINDOW (la vraie fenêtre)
   =========================== */
.window {
  position: relative;
  overflow: hidden;

  background: rgba(2, 9, 26, 0.55);
  border: 2px solid rgba(0, 255, 210, 0.55);
  box-shadow:
    0 0 22px rgba(0, 255, 210, 0.15),
    0 18px 70px rgba(0, 0, 0, 0.6);
  backdrop-filter: blur(10px);

  clip-path: polygon(
    18px 0%,
    100% 0%,
    100% calc(100% - 18px),
    calc(100% - 18px) 100%,
    0% 100%,
    0% 18px
  );
}

/* ===========================
   GLITCH LAYER (fenêtre entière)
   -> piloté par data-glitch="on"
   =========================== */
.glitchLayer {
  position: absolute;
  inset: -10px;       /* ✅ déborde pour bien couvrir bordure/cadre */
  z-index: 50;      /* ✅ au-dessus de TOUT */
  pointer-events: none;
  opacity: 0;
  mix-blend-mode: screen;


  /* ✅ très visible : barres + flash + cyan/violet */
  background:
    repeating-linear-gradient(
      to bottom,
      rgba(255,255,255,0) 0px,
      rgba(255,255,255,0) 7px,
      rgba(255,255,255,0.95) 8px,
      rgba(255,255,255,0) 14px
    ),
    linear-gradient(
      90deg,
      rgba(0,255,210,0.90),
      rgba(198,0,255,0.60),
      rgba(0,0,0,0)
    );

  mix-blend-mode: normal;  /* ✅ pas subtil */
  filter: contrast(1.6) brightness(1.25);

  /* même forme cut */
  clip-path: polygon(
    18px 0%,
    100% 0%,
    100% calc(100% - 18px),
    calc(100% - 18px) 100%,
    0% 100%,
    0% 18px
  );
}

/* ✅ activation par React => garanti */
.overlay[data-glitch="on"] .glitchLayer {
  opacity: 1;
  animation: glitchFull 420ms steps(2, end) 1 forwards;
}

@keyframes glitchFull {
  0%   { transform: translateX(0);     clip-path: inset(0 0 0 0);     opacity: 0; }
  12%  { transform: translateX(42px);  clip-path: inset(6% 0 78% 0);  opacity: 1; }
  35%  { transform: translateX(-56px); clip-path: inset(42% 0 40% 0); opacity: 1; }
  60%  { transform: translateX(32px);  clip-path: inset(76% 0 10% 0); opacity: 0.95; }
  100% { transform: translateX(0);     clip-path: inset(0 0 0 0);     opacity: 0; }
}

/* ===========================
   SCAN
   =========================== */
.scanlines {
  position: absolute;
  inset: 0;
  z-index: 3;
  pointer-events: none;
  opacity: 0.18;
  mix-blend-mode: overlay;

  background: repeating-linear-gradient(
    to bottom,
    rgba(255,255,255,0.06),
    rgba(255,255,255,0.06) 1px,
    rgba(0,0,0,0) 3px,
    rgba(0,0,0,0) 7px
  );
}

.scanBeam {
  position: absolute;
  left: -20%;
  right: -20%;
  top: -30%;
  height: 26%;
  z-index: 4;
  pointer-events: none;
  opacity: 0;
  transform: translateY(-120%);

  background: linear-gradient(
    to bottom,
    rgba(0,255,210,0),
    rgba(0,255,210,0.22),
    rgba(80,210,255,0.10),
    rgba(0,255,210,0)
  );
}

.overlay[data-phase="opening"] .scanBeam {
  opacity: 1;
  animation: beamDown 900ms ease-out forwards;
}

@keyframes beamDown {
  0%   { transform: translateY(-120%); opacity: 0; }
  20%  { opacity: 1; }
  100% { transform: translateY(280%);  opacity: 0; }
}

/* ===========================
   UI
   =========================== */
.header {
  position: relative;
  z-index: 2;
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 12px 14px;
  border-bottom: 1px solid rgba(0,255,210,0.2);
  background: linear-gradient(90deg, rgba(0,255,210,0.10), rgba(2,9,26,0));
}

.body {
  position: relative;
  z-index: 2;
  padding: 16px 14px 18px;
}

.dot {
  width: 10px;
  height: 10px;
  border-radius: 999px;
  background: #00ffd2;
  box-shadow: 0 0 14px rgba(0,255,210,0.45);
}

.title {
  letter-spacing: 1px;
  font-weight: 800;
  color: rgba(255,255,255,0.9);
}

.code {
  margin-left: auto;
  margin-right: 10px;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  color: rgba(0,255,210,0.85);
}

.closeBtn {
  appearance: none;
  border: 1px solid rgba(0,255,210,0.35);
  background: rgba(2,9,26,0.6);
  color: rgba(255,255,255,0.9);
  padding: 6px 10px;
  cursor: pointer;
  font-weight: 800;
  letter-spacing: 0.6px;
}

.closeBtn:hover {
  border-color: rgba(0,255,210,0.75);
}

.bar {
  height: 6px;
  width: 100%;
  background: rgba(0,255,210,0.12);
  position: relative;
  overflow: hidden;
}

.bar::after {
  content: "";
  position: absolute;
  inset: 0;
  width: 35%;
  background: linear-gradient(90deg, rgba(0,255,210,0), rgba(0,255,210,0.85), rgba(0,255,210,0));
  animation: barSweep 720ms ease-out forwards;
}

@keyframes barSweep {
  0%   { transform: translateX(-60%); opacity: 0; }
  25%  { opacity: 1; }
  100% { transform: translateX(220%); opacity: 0; }
}

.text {
  margin-top: 10px;
  color: rgba(255,255,255,0.78);
  letter-spacing: 0.4px;
  font-size: 0.95rem;
}

.actions{
  margin-top: 14px;
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
}

.btnPrimary{
  appearance: none;
  cursor: pointer;
  border: 1px solid rgba(0,255,210,0.45);
  background: rgba(2,9,26,0.7);
  color: rgba(255,255,255,0.92);
  padding: 10px 12px;
  font-weight: 900;
  letter-spacing: 1px;
  text-transform: uppercase;
}

.btnPrimary:hover{
  border-color: rgba(0,255,210,0.95);
  box-shadow: 0 0 18px rgba(0,255,210,0.18);
}

.btnGhost{
  appearance: none;
  cursor: pointer;
  border: 1px solid rgba(255,255,255,0.18);
  background: transparent;
  color: rgba(255,255,255,0.75);
  padding: 10px 12px;
  font-weight: 800;
  letter-spacing: 1px;
  text-transform: uppercase;
}

.btnGhost:hover{
  border-color: rgba(255,255,255,0.35);
  color: rgba(255,255,255,0.9);
}


.terminal{
  margin-top: 8px;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  color: rgba(0,255,210,0.85);
  font-size: 0.92rem;
  line-height: 1.45;
}

.line{
  opacity: 0.95;
}

.cursor{
  display: inline-block;
  width: 10px;
  height: 1em;
  margin-left: 6px;
  background: rgba(0,255,210,0.85);
  animation: blink 900ms steps(1,end) infinite;
  vertical-align: -2px;
}

@keyframes blink{
  50%{ opacity: 0; }
}


